
### 为什么 https 是安全的

http 不安全是因为他的传输是 tcp/ip，不对自己的承载的http 加密保护、完整性保护、服务器身份认证等。

如果，http在给tcp/ip传输之前，请求 TLS 的安保，提供以下服务

1. 加密保护，http内容加密，第三方无法知晓原始明文
2. 完整性保护，第三方篡改内容接收方就可以检测到并关闭安全连接
3. 服务器身份认证，强制检验服务器数字整数，确保服务器就是真正要通信的服务器
4. 防重放攻击保护，http都有一个线性增长的序列号，重放的话就会被检测并关闭

那么http就是安全的。

为了区别明文传输（tcp/ip）的http ，给密文传输（tls/tcp/ip）http标记为 https

**HTTPS 网站该如何传递参数？** 和http没区别

**如果和 HTTP一样那么不就是参数是明文的有被拦截的风险，怎么能说 HTTPS 是安全的呢？** tls 安全加密了，在tcp上传输，然后是 ip 在互联网上传输到目的地，然后校验，校验正确就开始解密 http 提交给应用层。

**为何HTTP不能实现自己的安全加密功能？而要借助TLS的安全加密服务？** 复用问题。单独做一层 tls 的会话层，上面的应用层就都不用做加密了

- 硬件接口物理层
- 硬件接口链路层 封装成Mac帧
- ip网络层 封装成 ip数据报
- tcp传输层 封装成 tcp 报文
- tls会话层
- http表示层
- http应用层

**脆弱性？** tcp承载的，伪造报文， reset 掉链接。就可以做攻击。


### 书上关于 ssl 和 tlc 的大致过程

浏览器A、服务器B
1. A 发送支持的算法
2. B 选择算法发送回A，到此为协商加密算法
3. B 发送自己的数字证书
4. A 用 CA 发布的公钥鉴定 B 的证书。这个世界上拥有 B 私钥的，只有 B 本人。
5. A 产生一个秘密数，用秘密数产生会话秘钥
6. 用 B 的公钥加密的秘密数 发送给 B
7. B 接收后，用这个秘密数产生会话秘钥，这时候双方都有会话秘钥了。
8. 数据传输（这时候大家都有秘钥了，开始加密传输）



### 紧接上文，数字证书

客户端先向服务器端索要公钥，然后用公钥加密信息，服务器收到密文后，用自己的私钥解密。

这就存在些问题，如何保证公钥不被篡改和信任度？

所以这里就需要借助第三方权威机构 `CA` （数字证书认证机构），将**服务器公钥放在数字证书**（由数字证书认证机构颁发）中，只要证书是可信的，公钥就是可信的。


解释：
- 按道理，B 的公钥发给 A ，A 拿这个公钥加密发送给 B 这是目的。
- 但是公钥 B 本身也会被篡改。
- 所以 B 把自己的公钥发给 CA 机构，CA 拿到公钥用 CA 私钥加密，生产数字证书给 B。
- 这时候 上面第三步，B 在通信的时候要发送自己的数字证书一并A
- A 拿到数字证书之后，用公钥解密，查看证书是否匹配。 对应第四步。


![[网络安全#公钥和私钥的工作原理]]

![[网络安全#数字签名的过程]]